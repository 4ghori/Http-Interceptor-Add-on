"use strict";function setTabRequestLog(e,t){chrome.storage.local.get(e,function(a){a[e]&&(a[e].log.push(t),chrome.storage.local.set(a))})}function setTabFilter(e,t){chrome.storage.local.get(e,function(a){a[e]?a[e].filter=t:a[e]={filter:t,log:[]},chrome.storage.local.set(a)})}function resetTab(e){chrome.storage.local.get(e,function(t){t[e]&&(t[e]={filter:t[e].filter,log:[]},chrome.storage.local.set(t))})}function getParameterByName(e,t){e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=a.exec(t);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function _isContains(e,t){var a=!1;return Object.keys(e).some(function(o){return a="object"===_typeof(e[o])?_isContains(e[o],t):e[o]===t}),a}function _isAdConfig(e){return!!e.includes("requestConfig.php?")}function _isAdType(e,t){var a="";return a=getParameterByName("bdata",e)?getParameterByName("ver",e)?getParameterByName("hasDeal",e)&&getParameterByName("callback",e)?"Incentivised Ad":"Interstitial Ad":"Medium Rectangle Ad":"Banner Ad",a==t}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},activeTab={windowId:-1,tabId:-1},popupData={warningclass:"hide",rLog:""};chrome.runtime.onInstalled.addListener(function(e){chrome.storage.local.set({activeTab:{windowId:-1,tabId:-1}}),console.log("previousVersion",e.previousVersion)}),chrome.tabs.query({active:!0},function(e){chrome.storage.local.clear(),e.length>0&&(chrome.storage.local.set({activeTab:{windowId:e[0].windowId,tabId:e[0].tabId}}),chrome.storage.local.get(e[0].tabId.toString(),function(t){activeTab=t[e[0].tabId]?{windowId:e[0].windowId,tabId:e[0].tabId,filter:t[e[0].tabId].filter}:{windowId:e[0].windowId,tabId:e[0].tabId}}))}),chrome.storage.onChanged.addListener(function(e,t){if(e.activeTab&&e.activeTab.newValue){var a=e.activeTab.newValue;a.tabId&&chrome.storage.local.get(a.tabId.toString(),function(e){activeTab=e[a.tabId]?{windowId:a.windowId,tabId:a.tabId,filter:e[a.tabId].filter}:{windowId:a.windowId,tabId:a.tabId}})}if(e[activeTab.tabId]&&e[activeTab.tabId].newValue){var a=e[activeTab.tabId].newValue;activeTab={windowId:activeTab.windowId,tabId:activeTab.tabId,filter:a.filter}}}),chrome.tabs.onActivated.addListener(function(e){chrome.storage.local.set({activeTab:{windowId:e.windowId,tabId:e.tabId}}),chrome.storage.local.get(e.tabId.toString(),function(t){activeTab=t[e.tabId]?{windowId:e.windowId,tabId:e.tabId,filter:t[e.tabId].filter}:{windowId:e.windowId,tabId:e.tabId}})}),chrome.tabs.onUpdated.addListener(function(e,t){void 0!==t.url&&(chrome.browserAction.setBadgeText({text:"",tabId:e}),console.log("lul"),resetTab(e.toString()))}),chrome.tabs.onRemoved.addListener(function(e,t){chrome.storage.local.remove(e.toString())}),chrome.webRequest.onBeforeRequest.addListener(function(e){var t={"Banner Ad":"5E88E58887","Interstitial Ad":"F7B4F58641","Incentivised Ad":"21C5A58784","Medium Rectangle Ad":"4D2B658660"};if(e.tabId==activeTab.tabId&&activeTab.filter&&e.url.includes("rya")&&e.url.includes("placeguid")&&(_isAdType(e.url,activeTab.filter.adType)||_isAdConfig(e.url))){var a=getParameterByName("placeguid",e.url);if(_isContains(t,a)){var o={placeguid:getParameterByName("placeguid",e.url),url:e.url,type:"success"};setTabRequestLog(activeTab.tabId.toString(),o),chrome.browserAction.setBadgeText({text:"!",tabId:e.tabId})}else{var o={placeguid:getParameterByName("placeguid",e.url),url:e.url,type:"warning"};setTabRequestLog(activeTab.tabId.toString(),o),chrome.browserAction.setBadgeText({text:"!",tabId:e.tabId})}return{redirectUrl:e.url.replace(/(placeguid=).*?(&|$)/,"$1"+t[activeTab.filter.adType]+"$2")}}},{urls:["<all_urls>"],types:["main_frame","sub_frame","xmlhttprequest"]},["blocking"]);
//# sourceMappingURL=background.js.map
